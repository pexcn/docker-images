From 01f528af72a04d5f2f1f6f891a12ff2d8f5c7c13 Mon Sep 17 00:00:00 2001
From: pexcn <pexcn97@gmail.com>
Date: Thu, 2 Feb 2023 02:38:01 +0000
Subject: [PATCH] ~/.acme.sh/host -> /.acme.sh/host

---
 src/server.rs | 9 +++------
 1 file changed, 3 insertions(+), 6 deletions(-)

diff --git a/src/server.rs b/src/server.rs
index bcd6c5f..424ae65 100644
--- a/src/server.rs
+++ b/src/server.rs
@@ -4,7 +4,6 @@ use std::path::PathBuf;
 use std::sync::Arc;
 
 use anyhow::{Context, Result};
-use dirs::home_dir;
 use env_logger::Builder;
 use futures::future::try_join;
 use futures::TryFutureExt;
@@ -47,7 +46,7 @@ struct Opt {
     /// Address to listen on
     #[structopt(long = "relay", default_value = "127.0.0.1:8138")]
     relay: SocketAddr,
-    /// Specify the host to load TLS certificates from ~/.acme.sh/host
+    /// Specify the host to load TLS certificates from /.acme.sh/host
     #[structopt(long = "acme-host")]
     acme_host: Option<String>,
 }
@@ -86,12 +85,10 @@ async fn main() -> Result<()> {
 
     if let Some(host) = acme_host {
         key_path = PathBuf::new();
-        key_path.push(home_dir().unwrap_or_else(|| PathBuf::from("~")));
-        key_path.push(format!(".acme.sh/{a}/{a}.key", a = host));
+        key_path.push(format!("/.acme.sh/{a}/{a}.key", a = host));
 
         cert_path = PathBuf::new();
-        cert_path.push(home_dir().unwrap_or_else(|| PathBuf::from("~")));
-        cert_path.push(format!(".acme.sh/{}/fullchain.cer", host));
+        cert_path.push(format!("/.acme.sh/{}/fullchain.cer", host));
     }
 
     info!("loading cert: {:?}", cert_path);
-- 
2.38.3

